<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Micro:bit è‡ªå‹•èª¿å…‰æ¨¡æ“¬å™¨</title>
    <!-- è¼‰å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¨­å®š Inter å­—é«”ï¼Œä½¿ç”¨æ·±è‰²èƒŒæ™¯ä»¥æ¨¡æ“¬å¤œé–“æˆ–æš—è™•ï¼Œä¸¦è®“ LED ç™¼å…‰æ•ˆæœæ›´æ˜é¡¯ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; 
            color: #e5e7eb;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* LED è¦–è¦ºåŒ–æ¨£å¼ */
        #led-output {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background-color: #ffcc00; /* åŸºç¤é¡è‰²: é»ƒè‰² */
            transition: box-shadow 0.3s ease-out, opacity 0.3s ease-out;
            border: 5px solid #ffaa00;
        }

        /* ç¯„åœè¼¸å…¥æ¢æ¨£å¼èª¿æ•´ (ç¢ºä¿åœ¨æ·±è‰²èƒŒæ™¯ä¸‹å¯è¦‹) */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #4b5563;
            border-radius: 4px;
            outline: none;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #3b82f6; /* è—è‰²æ‹‡æŒ‡ */
            cursor: pointer;
            border: 3px solid #bfdbfe;
            box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
        }
        
        /* æ–°å¢ï¼šæ‰‹éƒ¨è¦–è¦ºåŒ–æ¨£å¼ */
        .sensor-visual {
            position: relative;
            height: 100px; 
            overflow: hidden; /* ç¢ºä¿æ‰‹éƒ¨åœ¨ L=0 æ™‚çœ‹ä¸è¦‹ */
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .sensor-base {
            z-index: 1;
            /* è®“ç‡ˆæ³¡åœ¨ä¸­å¤® */
        }
        .hand-overlay {
            position: absolute;
            z-index: 2;
            left: 50%;
            /* åˆå§‹ transform å°‡ç”± JS è¨­å®š */
            transition: transform 0.3s ease-out; 
            line-height: 1; /* èª¿æ•´è¡Œé«˜è®“ emoji å±…ä¸­ */
        }

    </style>
</head>
<body>

    <div id="app" class="p-8 md:p-12 bg-gray-800 rounded-2xl shadow-2xl max-w-4xl w-full">
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-yellow-400 tracking-tight">
                Micro:bit åå‘æ§åˆ¶æ„Ÿæ‡‰ç‡ˆæ¨¡æ“¬
            </h1>
            <p class="text-lg text-gray-400 mt-3">
                é€éèª¿æ•´ç’°å¢ƒå…‰ç·šï¼Œè§€å¯Ÿ LED äº®åº¦çš„è‡ªå‹•åå‘è®ŠåŒ–ã€‚
            </p>
        </header>

        <div class="flex flex-col lg:flex-row gap-10">
            <!-- å·¦å´: è¼¸å…¥èˆ‡é‚è¼¯ -->
            <div class="lg:w-1/2 space-y-8 p-4 bg-gray-700 rounded-xl">
                
                <h2 class="2xl font-semibold text-white border-b border-gray-600 pb-3">è¼¸å…¥ï¼šæ¨¡æ“¬å…‰ç·šæ„Ÿæ¸¬å™¨</h2>

                <!-- æ–°å¢ï¼šåœ–åƒåŒ–é¡¯ç¤º (æ‰‹éƒ¨è¦†è“‹) -->
                <div class="sensor-visual rounded-lg bg-gray-900 shadow-inner">
                    <!-- æ„Ÿæ¸¬å™¨åº•åº§ (Micro:bit ä¸Š LED è¢å¹•å…¼å…·æ„Ÿæ¸¬å™¨åŠŸèƒ½) -->
                    <div class="sensor-base text-6xl">ğŸ’¡</div>
                    <!-- æ‰‹éƒ¨è¦†è“‹ -->
                    <div id="hand-overlay" class="hand-overlay text-7xl">âœ‹</div>
                </div>

                <!-- 1. å…‰ç·šæ„Ÿæ¸¬å™¨è¼¸å…¥ -->
                <div>
                    <label for="lightSensor" class="block text-xl font-medium mb-2">
                        ç’°å¢ƒå…‰ç·šå¼·åº¦ (0-255): <span id="light-value" class="text-yellow-400 font-bold">128</span>
                    </label>
                    <input type="range" id="lightSensor" min="0" max="255" value="128" step="1" oninput="updateSimulation(this.value)">
                    <div class="flex justify-between text-sm mt-1 text-gray-400">
                        <!-- é‚è¼¯åè½‰å¾Œçš„æ¨™ç±¤ï¼š0 (æš—) -> æ‰‹è¦†è“‹ (æ¨¡æ“¬æ„Ÿæ¸¬å™¨è®€æ•¸ä½)ï¼›255 (äº®) -> æ‰‹ç§»é–‹ (æ¨¡æ“¬æ„Ÿæ¸¬å™¨è®€æ•¸é«˜) -->
                        <span>0 (æ¥µæš—ï¼Œæ‰‹è¦†è“‹/ä¸­å¤®)</span>
                        <span>255 (æ¥µäº®ï¼Œæ‰‹ç§»é–‹/ä¸å¯è¦‹)</span>
                    </div>
                </div>

                <!-- 2. ç¨‹å¼é‚è¼¯ (æµç¨‹åœ–/æç¤ºå€å¡Š) -->
                <h2 class="text-2xl font-semibold text-white border-b border-gray-600 pb-3 mt-8">MakeCode é‚è¼¯æ¨¡æ“¬</h2>
                <div class="bg-gray-900 p-4 rounded-lg text-lg">
                    <p class="mb-2 text-yellow-300 font-mono">
                        // æˆ‘å€‘çš„ç›®æ¨™æ˜¯åå‘æ§åˆ¶ï¼šå…‰ç·šå¼·ï¼ŒLED æš—
                    </p>
                    <div class="font-mono bg-blue-900 p-3 rounded-md shadow-lg">
                        <p class="text-blue-200">ç•¶æ°¸é åŸ·è¡Œæ™‚:</p>
                        <p class="ml-4 text-white">
                            <span class="text-green-400">è¨­å®š LED äº®åº¦</span> 
                            = 255 - (<span class="text-red-400">å…‰ç·šæ„Ÿæ¸¬å™¨æ•¸å€¼</span>)
                        </p>
                        <p class="text-blue-200">
                            <span class="text-green-400">LED äº®åº¦</span> ç¯„åœ: 0 ~ 255
                        </p>
                    </div>
                </div>
            </div>

            <!-- å³å´: è¼¸å‡ºèˆ‡è¦–è¦ºåŒ– -->
            <div class="lg:w-1/2 space-y-8 p-4 bg-gray-700 rounded-xl flex flex-col items-center justify-center">
                
                <h2 class="text-2xl font-semibold text-white border-b border-gray-600 pb-3 w-full text-center">è¼¸å‡ºï¼šLED äº®åº¦æ§åˆ¶</h2>

                <!-- 3. LED äº®åº¦æ•¸å€¼è¼¸å‡º -->
                <div class="text-center">
                    <p class="text-xl text-gray-400">
                        è¨ˆç®—å‡ºçš„ LED äº®åº¦ (0-255):
                    </p>
                    <!-- æ–°å¢è¨ˆç®—å…¬å¼é¡¯ç¤º -->
                    <p id="calculation-display" class="text-2xl font-bold text-blue-400 mt-2 mb-4"></p>
                    <p id="brightness-value" class="text-6xl font-extrabold text-pink-400 mt-2">127</p>
                </div>
                
                <!-- 4. è¦–è¦ºåŒ– LED -->
                <div id="led-output" class="shadow-2xl">
                    <!-- æ¨¡æ“¬ LED ç‡ˆ -->
                </div>

                <p class="text-sm text-gray-400 mt-4 text-center">
                    **æç¤º:** ç•¶ç’°å¢ƒå…‰å€¼ç‚º 0 æ™‚ï¼ŒLED äº®åº¦ç‚º 255 (æœ€äº®)ã€‚ç•¶ç’°å¢ƒå…‰å€¼ç‚º 255 æ™‚ï¼ŒLED äº®åº¦ç‚º 0 (æœ€æš—)ã€‚
                </p>
            </div>
        </div>
    </div>

    <script>
        /**
         * æ ¹æ“šå…‰ç·šæ„Ÿæ¸¬å™¨æ•¸å€¼æ›´æ–° LED äº®åº¦æ¨¡æ“¬
         * @param {string} lightValueStr - å…‰ç·šæ„Ÿæ¸¬å™¨è®€å–çš„æ•¸å€¼ (0-255)
         */
        function updateSimulation(lightValueStr) {
            const lightValue = parseInt(lightValueStr, 10);
            
            // 1. åŸ·è¡Œåå‘æ§åˆ¶é‚è¼¯ (255 - è¼¸å…¥å€¼)
            const brightness = 255 - lightValue;

            // 2. æ›´æ–°æ•¸å€¼é¡¯ç¤º
            document.getElementById('light-value').textContent = lightValue;
            document.getElementById('brightness-value').textContent = brightness;
            
            // é¡¯å¼å±•ç¤ºè¨ˆç®—å…¬å¼ (æ–°å¢éƒ¨åˆ†)
            const calculationDisplayElement = document.getElementById('calculation-display');
            calculationDisplayElement.textContent = `LED äº®åº¦ = 255 - ${lightValue} = ${brightness}`;

            
            // 3. æ›´æ–° LED è¦–è¦ºåŒ–
            const ledElement = document.getElementById('led-output');

            // a) è¨ˆç®— LED çš„å…‰æšˆå¼·åº¦
            // å°‡ brightness (0-255) è½‰æ›ç‚ºä¸€å€‹ç›¸å°å¼·åº¦ï¼Œä¸¦ç¢ºä¿å³ä½¿æ˜¯ 0 ä¹Ÿä¸å®Œå…¨æ¶ˆå¤±
            
            // åŸºç¤ç™¼å…‰å¼·åº¦ (å¾ 0 åˆ° 150 åƒç´ æ“´æ•£)
            const shadowSpread = (brightness / 255) * 150;
            
            // åŸºç¤é¡è‰² (FFCC00)
            const colorR = 255;
            const colorG = 204;
            const colorB = 0;
            
            // æ ¹æ“šäº®åº¦èª¿æ•´é¡è‰²çš„é€æ˜åº¦ (alpha)
            const alpha = brightness / 255; 
            
            // è¨­ç½®ç™¼å…‰é¡è‰²ï¼Œä½¿å…¶åœ¨äº®åº¦é«˜æ™‚æ›´æ¿ƒéƒ
            const glowColor = `rgba(${colorR}, ${colorG}, ${colorB}, ${alpha * 0.8})`;
            
            // è¨­ç½®å…§é™°å½±ï¼Œæ¨¡æ“¬ LED æœ¬èº«åœ¨äº®èµ·æ™‚çš„æŸ”å’Œå…‰èŠ’
            const innerShadow = `inset 0 0 15px rgba(255, 255, 255, ${alpha * 0.7})`;

            // è¨­ç½®å¤–ç™¼å…‰ (ä½¿ç”¨å¤šå±¤é™°å½±ä½¿å…‰æšˆæ›´æŸ”å’Œ)
            const outerShadow = `0 0 ${shadowSpread}px ${glowColor}, 0 0 ${shadowSpread / 2}px ${glowColor}`;

            // æ‡‰ç”¨æ¨£å¼
            ledElement.style.boxShadow = `${innerShadow}, ${outerShadow}`;
            ledElement.style.opacity = 0.5 + (alpha * 0.5); // ç¢ºä¿åœ¨æ¥µæš—æ™‚ä»æœ‰å¾®å¼±å¯è¦‹åº¦


            // 4. æ›´æ–°æ‰‹éƒ¨è¦–è¦ºåŒ–
            const handElement = document.getElementById('hand-overlay');
            
            // *** èª¿æ•´å¾Œçš„æ•¸å€¼ï¼šåè½‰æ‰‹éƒ¨é‚è¼¯ ***
            // L=0 (æ¥µæš—/æ‰‹è“‹ä½) æ™‚çš„ç›®æ¨™ Y åº§æ¨™ (æ‰‹éƒ¨å®Œå…¨è¦†è“‹æ„Ÿæ¸¬å™¨)
            const coveringPosition = 0; 
            
            // L=255 (æ¥µäº®/æ‰‹ç§»é–‹) æ™‚çš„ç›®æ¨™ Y åº§æ¨™ (æ‰‹éƒ¨å®Œå…¨ç§»é–‹/éš±è—æ–¼ä¸‹æ–¹)
            const uncoveredPosition = 100; 
            
            // ç¸½ç§»å‹•è·é›¢: 100px - 0px = 100px
            const totalMoveDistance = uncoveredPosition - coveringPosition; 

            // è¨ˆç®—ç•¶å‰æ•¸å€¼ä¸‹ï¼Œæ‰‹éƒ¨å‘ä¸‹ç§»å‹•äº†å¤šå°‘é‡ (L=0 æ™‚ç‚º 0, L=255 æ™‚ç‚º 100)
            // L=0: moveDownAmount = 0 (åœ¨ 0px) -> è¦†è“‹
            // L=255: moveDownAmount = 100 (åœ¨ 100px) -> ç§»é–‹/éš±è—
            const moveDownAmount = (lightValue / 255) * totalMoveDistance;

            // æœ€çµ‚çš„ Y åº§æ¨™
            const finalYPosition = coveringPosition + moveDownAmount; 

            handElement.style.transform = `translateX(-50%) translateY(${finalYPosition}px)`;
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–æ¨¡æ“¬
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–æ™‚ä½¿ç”¨é è¨­å€¼ 128
            updateSimulation(128); 
        });

    </script>

</body>
</html>
